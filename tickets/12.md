# КЭШ-память. Назначение. Принцип функционирования.

При обращение процессором на прямую к оперативной памяти, ОП не успевает обслуживать поступающие заявки, процессору в этом случае приходится простаивать. Поэтому необходимо какими-либо методами согласовать быстродействие процессора и ОП. Сделать это можно 2 способами:

1. Построить ОП на более быстродействующей элементной базе (дорогостоящий)

2. Использовать специальное структурное решение при организации уровней подсистемы памяти, а именно включений между процессором и ОП быстродействующий КЭШ.

Отличительными особенностями КЭШ являются:

1. Малый объем (от 8кбайт)
2. Быстродействие сравнимое с быстродействием процессора.


![КЭШ](/resources/imgs/t12_1.PNG)

Суть заключается в следующем, когда процессору понадобилась информация, сначала он обращается к КЭШ памяти, если информация там есть (такое событие называется КЭШ попаданием), то нужное слово извлекается из КЭШ и передается процессору. Если нет (КЭШ промах), то идет обращение к оперативной памяти, информация помещается в КЭШ затем передается процессору.

![Эффективность КЭШ](/resources/imgs/t12_2.PNG)

Пусть ОП состоит из 2n адресуемых слов, можно представить ОП под совокупность блоков фиксированной длинны по «к» слов в каждом. Тогда емкость оперативной памяти можно записать следующим выражением M= 2n/k.

КЭШ память состоит из C строк по «к» слов в каждой. Причем емкость КЭШ во много раз меньше емкости ОП.

В процессе выполнения задачи, некоторое подмножество блоков в ОП находятся строго в КЭШ. Каждая строка в КЭШ снабжается ТЭГом, является служебной областью, как правило ТЭГ содержит старшие разряды поля адресов памяти. ТЭГ нужен для установления соответствия между ОП и КЭШ.

## Структурная организация КЭШ

![Структурная организация КЭШ](/resources/imgs/t12_3.PNG)

Важной отличительной особенностью КЭШ является то, что две операции передачи слова и загрузка блока  в ОП могут происходить одновременно. КЭШ соединен с процессором линиями: адрес, данные, управление. Линии данные и адрес подключены к соответствующим буфером. Эти буферы имеют выход на системную магистраль, через которую они могут обмениваться с ОП информацией. Если происходит событие КЭШ попадания, то буферы адреса и данных блокируется.

Если происходит КЭШ попадание, то буферы адреса и данных блокируются, весь процесс обращения ведется  без участия ОП.

Если происходит событие КЭШ промах, то затребованный процессором адрес выставляется в буфер адреса , передается на системную магистраль, затем происходит поиск в ОП, блок информации копируется в буфер данных, затем передается в КЭШ, затем ЦП.
